import{_ as G,x as O,y as H,r as d,z as J,g as K,c as n,b as i,f as P,t as c,e as b,w as U,i as m,R as W,m as $,n as q,p as x,a as X,o as l,l as o,j as y,A as T,F as Z,s as ee,k as te,v as ae}from"./index-e9uV_RJ-.js";import{c as se,e as B,a as Q,F as le,b as I}from"./index.esm-DzTv-fv4.js";import{s as ie}from"./index-Ms2GMVUW.js";import{r as oe}from"./ArrowUpTrayIcon-BTsZDYuX.js";import{r as ue}from"./XMarkIcon-DjUejM8q.js";import{r as ne}from"./ArrowPathIcon-D9-DHQV_.js";const de={class:"bg-screen add-edit-form"},me={class:"w-full md:w-5/6 shadow-2xl my-4 sm:my-6 md:my-8 p-4 sm:p-6 md:p-8 mx-auto",style:{background:"rgb(250, 200, 200, 0.25)"}},re={class:"main-title"},ce={class:"auth-detail"},pe={class:"w-full sm:w-1/2 p-0 sm:px-2"},ve={key:0,class:"input-shimmer"},ye={key:2,class:"error-message"},fe={class:"w-full sm:w-1/2 p-0 sm:px-2"},ge={key:0,class:"input-shimmer"},he=["value"],we={key:2,class:"error-message"},ke={class:"w-full sm:w-1/2 p-0 sm:px-2"},_e={key:0,class:"textarea-shimmer"},be={key:2,class:"error-message"},xe={class:"w-full sm:w-1/2 p-0 sm:px-2"},Ie={key:0,class:"input-shimmer"},Ve={key:2,class:"error-message"},Ce={key:3,class:"input-shimmer"},Ue={key:5,class:"error-message"},$e={class:"w-full sm:w-1/2 p-0 sm:px-2"},qe={key:0,for:"image",style:{display:"flex"},class:"items-center"},Ae={key:1,class:"relative mt-2 sm:mt-2 md:mt-4 w-16 sm:w-20 md:w-24 h-16 sm:h-20 md:h-24"},De=["src"],Ee={class:"w-full sm:w-1/2 p-0 sm:px-2 mt-1"},Fe={key:0,for:"available",class:"flex items-center font-semibold text-sm sm:text-base"},Pe=["disabled"],Qe={__name:"AddEditItem",setup(Te){const A=H(),V=X(),R=se({Title:Q().required().max(50),Description:Q().required().max(500),Category:Q().required(),Price:B().required().min(1).max(1e4).typeError("Price must be a valid number").positive("Price must be greater than zero").test("decimal-check","Price can have up to two decimal places",t=>/^\d+(\.\d{1,2})?$/.test((t==null?void 0:t.toString())||"")),Quantity:B().required().min(1).max(50).typeError("Quantity must be a valid number").positive("Quantity must be greater than zero").test("decimal-check","Quantity can have up to two decimal places",t=>/^\d+(\.\d{1,2})?$/.test((t==null?void 0:t.toString())||""))}),r=O(()=>{var t;return(t=A==null?void 0:A.params)==null?void 0:t.id}),D=d([]),g=d(""),h=d(""),w=d(),k=d(),_=d(),E=d(),p=d(),v=d(),C=d(!1),f=d(!1),u=d(!1),Y=t=>{const e=t.target.files[0];e&&(p.value=e,v.value=URL.createObjectURL(e))},L=()=>{p.value=null,v.value=null,E.value.value=null},N=()=>{ie.fire({title:"No Category Found",text:"First You Should Add Category.",icon:"warning",showCancelButton:!1}).then(t=>{t.isConfirmed&&V.push("/category/add-category")})},S=async()=>{u.value=!0,await $.get(`${q.getItem}${r.value}`).then(({data:t})=>{let e=t.data;g.value=e.title,h.value=e.description,v.value=e.image,w.value=e.categoryId._id,k.value=e.price,_.value=e.quantity,C.value=e.isActive}).catch(t=>{var e,a;x.error((a=(e=t==null?void 0:t.response)==null?void 0:e.data)==null?void 0:a.message),V.push("/item")}).finally(()=>{u.value=!1})},j=async()=>{await $.get(q.listCategory).then(({data:t})=>{var e,a;D.value=((e=t==null?void 0:t.data)==null?void 0:e.categories)??[],(a=D.value)!=null&&a.length||N()}).catch(t=>{var e,a;console.error((a=(e=t==null?void 0:t.response)==null?void 0:e.data)==null?void 0:a.message)})},z=async()=>{f.value=!0;let t=new FormData;t.append("title",g.value),t.append("description",h.value),p.value&&t.append("image",p.value),t.append("categoryId",w.value),t.append("price",k.value),t.append("quantity",_.value),await $.post(q.createItem,t,{headers:{"Content-Type":"multipart/form-data"}}).then(()=>{x.success("Item created successfully!!"),V.push("/item")}).catch(e=>{var a,s;x.error((s=(a=e==null?void 0:e.response)==null?void 0:a.data)==null?void 0:s.message)}).finally(()=>{f.value=!1})},M=async()=>{f.value=!0;let t=new FormData;t.append("title",g.value),t.append("description",h.value),(p.value||!v.value&&!p.value)&&t.append("image",p.value),t.append("categoryId",w.value),t.append("price",k.value),t.append("quantity",_.value),t.append("isActive",C.value),await $.put(`${q.updateItem}${r.value}`,t,{headers:{"Content-Type":"multipart/form-data"}}).then(()=>{x.success("Item updated successfully!!"),V.push("/item")}).catch(e=>{var a,s;x.error((s=(a=e==null?void 0:e.response)==null?void 0:a.data)==null?void 0:s.message)}).finally(()=>{f.value=!1})};return J(r,()=>{r.value&&S()},{immediate:!0}),K(()=>j()),(t,e)=>(l(),n("section",de,[i("div",me,[i("h1",re,c(r.value?"Update ":"Add ")+" Item",1),i("p",ce,[b(c(r.value?"Update an existing dish in just a few clicks.":"Add a new your favorite food items with our simple details.")+" ",1),P(m(W),{to:"/item",class:"route-link"},{default:U(()=>e[9]||(e[9]=[b("Back to Item list")])),_:1})]),P(m(le),{onSubmit:e[8]||(e[8]=a=>r.value?M():z()),"validation-schema":m(R),class:"flex flex-col sm:flex-row flex-wrap"},{default:U(({errors:a})=>[i("div",pe,[e[10]||(e[10]=i("label",{for:"title"},"Title",-1)),u.value?(l(),n("p",ve)):o("",!0),u.value?o("",!0):(l(),y(m(I),{key:1,modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=s=>g.value=s),type:"text",name:"Title",id:"title",class:"input",placeholder:"Enter Your Title"},null,8,["modelValue"])),u.value?o("",!0):(l(),n("p",ye,c(a==null?void 0:a.Title),1))]),i("div",fe,[e[11]||(e[11]=i("label",{for:"category"},"Category",-1)),u.value?(l(),n("p",ge)):o("",!0),u.value?o("",!0):(l(),y(m(I),{key:1,modelValue:w.value,"onUpdate:modelValue":e[1]||(e[1]=s=>w.value=s),name:"Category"},{default:U(({field:s})=>[i("select",T(s,{id:"category",class:"input",placeholder:"Enter Your Category"}),[(l(!0),n(Z,null,ee(D.value,F=>(l(),n("option",{key:F._id,value:F._id},c(F.title),9,he))),128))],16)]),_:1},8,["modelValue"])),u.value?o("",!0):(l(),n("p",we,c(a==null?void 0:a.Category),1))]),i("div",ke,[e[12]||(e[12]=i("label",{for:"description"},"Description",-1)),u.value?(l(),n("p",_e)):o("",!0),u.value?o("",!0):(l(),y(m(I),{key:1,modelValue:h.value,"onUpdate:modelValue":e[2]||(e[2]=s=>h.value=s),name:"Description"},{default:U(({field:s})=>[i("textarea",T(s,{id:"description",class:"input h-40",placeholder:"Enter Your Description"}),null,16)]),_:1},8,["modelValue"])),u.value?o("",!0):(l(),n("p",be,c(a==null?void 0:a.Description),1))]),i("div",xe,[e[13]||(e[13]=i("label",{for:"price"},"Price",-1)),u.value?(l(),n("p",Ie)):o("",!0),u.value?o("",!0):(l(),y(m(I),{key:1,modelValue:k.value,"onUpdate:modelValue":e[3]||(e[3]=s=>k.value=s),type:"number",name:"Price",id:"price",class:"input",placeholder:"Enter Your Price"},null,8,["modelValue"])),u.value?o("",!0):(l(),n("p",Ve,c(a==null?void 0:a.Price),1)),e[14]||(e[14]=i("label",{for:"quantity"},"Quantity",-1)),u.value?(l(),n("p",Ce)):o("",!0),u.value?o("",!0):(l(),y(m(I),{key:4,modelValue:_.value,"onUpdate:modelValue":e[4]||(e[4]=s=>_.value=s),type:"number",name:"Quantity",id:"quantity",class:"input",placeholder:"Enter Your Quantity"},null,8,["modelValue"])),u.value?o("",!0):(l(),n("p",Ue,c(a==null?void 0:a.Quantity),1))]),i("div",$e,[u.value?o("",!0):(l(),n("label",qe,[e[15]||(e[15]=b(" Upload Image ")),v.value?o("",!0):(l(),y(m(oe),{key:0,class:"upload-button mx-2",onClick:e[5]||(e[5]=s=>E.value.click())})),i("input",{type:"file",accept:"image/*",ref_key:"file",ref:E,hidden:"",onChange:Y},null,544)])),v.value?(l(),n("div",Ae,[P(m(ue),{class:"remove-image",onClick:e[6]||(e[6]=s=>L())}),i("img",{src:v.value,alt:"Uploaded Image",class:"uploaded-img-box"},null,8,De)])):o("",!0)]),i("div",Ee,[r.value&&!u.value?(l(),n("label",Fe,[te(i("input",{"onUpdate:modelValue":e[7]||(e[7]=s=>C.value=s),type:"checkbox",id:"available",class:"w-4 h-4 cursor-pointer mr-2"},null,512),[[ae,C.value]]),e[16]||(e[16]=b(" Available "))])):o("",!0)]),i("button",{class:"w-full sm:w-1/2 shrink",type:"submit",disabled:f.value},[b(c(r.value?"Edit ":"Add ")+" Item ",1),f.value?(l(),y(m(ne),{key:0,class:"loading-btn"})):o("",!0)],8,Pe)]),_:1},8,["validation-schema"])])]))}},je=G(Qe,[["__scopeId","data-v-2c8cfcee"]]);export{je as default};
